# Database Schema Organization Diagram

## Current State (Mixed in public schema)
```
public schema (69 tables mixed together)
â”œâ”€â”€ orders, order_items, products
â”œâ”€â”€ users, profiles, organizations  
â”œâ”€â”€ beneficiaries, bulk_payments
â”œâ”€â”€ memory_entries, ai_recommendations
â”œâ”€â”€ company_projects, company_services
â””â”€â”€ ... (64 more tables)
```

## Proposed State (Separated by Project)

### ğŸ›’ E-commerce Schema (ecommerce)
```
ecommerce schema
â”œâ”€â”€ orders, order_items
â”œâ”€â”€ products, product_embeddings
â”œâ”€â”€ marketplace_transactions
â”œâ”€â”€ payment_items, payment_audit, user_payments
â”œâ”€â”€ say_orders, say_bills, say_transfers
â”œâ”€â”€ stripe_connect_accounts
â”œâ”€â”€ subscriptions
â””â”€â”€ virtual_cards
```

### ğŸ¢ SaaS Platform Schema (saas_platform)
```
saas_platform schema
â”œâ”€â”€ company_projects, company_services
â”œâ”€â”€ company_endpoints, company_usage_logs
â”œâ”€â”€ api_keys, vendor_api_keys
â”œâ”€â”€ organizations, users, profiles
â”œâ”€â”€ user_roles, user_sessions, user_tiers
â”œâ”€â”€ notification_settings, notifications
â”œâ”€â”€ sessions, oauth_sessions
â”œâ”€â”€ webhook_logs, system_error_logs
â””â”€â”€ usage_tracking
```

### ğŸ¦ Banking Services Schema (banking_services)
```
banking_services schema
â”œâ”€â”€ beneficiaries, bulk_payments
â”œâ”€â”€ business_financial_insights
â”œâ”€â”€ business_profiles
â”œâ”€â”€ edoc_consents, edoc_financial_analysis
â”œâ”€â”€ edoc_transactions, edoc_usage_logs
â”œâ”€â”€ risk_analysis
â”œâ”€â”€ user_consents
â”œâ”€â”€ agent_banks_memories
â”œâ”€â”€ agent_banks_memory_search_logs
â””â”€â”€ agent_banks_sessions
```

### ğŸ¤– AI Services Schema (ai_services)
```
ai_services schema
â”œâ”€â”€ memory_entries, memory_access_patterns
â”œâ”€â”€ memory_search_analytics
â”œâ”€â”€ ai_recommendations, ai_response_cache
â”œâ”€â”€ ai_usage_logs
â”œâ”€â”€ chat_conversations, chat_messages
â”œâ”€â”€ imported_data, search_history
â”œâ”€â”€ query_classifications
â”œâ”€â”€ recommendations, pricing_insights
â””â”€â”€ topics
```

### ğŸ”§ Shared Services Schema (shared_services)
```
shared_services schema
â”œâ”€â”€ feature_flags
â””â”€â”€ simple_users
```

## Benefits of Separation

### 1. Clear Project Boundaries
- Each project has its own dedicated schema
- No more confusion about table ownership
- Easy to identify project-specific data

### 2. Improved Security
- Schema-level access control
- Project-specific RLS policies
- Better data isolation

### 3. Better Performance
- Schema-specific indexing
- Reduced cross-project queries
- Better query optimization

### 4. Easier Maintenance
- Clear separation of concerns
- Easier backup/restore per project
- Simplified development

### 5. Scalability
- Independent optimization per schema
- Project-specific features
- Better resource allocation

## Migration Path

1. **Create schemas** (ecommerce, saas_platform, banking_services, ai_services, shared_services)
2. **Move tables** to appropriate schemas
3. **Update foreign keys** to reference new schema locations
4. **Update RLS policies** for new schemas
5. **Update application code** to use new schema references
6. **Test thoroughly** before production deployment

## Application Code Changes

### Before (Mixed):
```javascript
const orders = await supabase.from('orders').select('*');
const users = await supabase.from('users').select('*');
const beneficiaries = await supabase.from('beneficiaries').select('*');
```

### After (Separated):
```javascript
const orders = await supabase.from('ecommerce.orders').select('*');
const users = await supabase.from('saas_platform.users').select('*');
const beneficiaries = await supabase.from('banking_services.beneficiaries').select('*');
```

This separation will give you clear project boundaries and make it much easier to manage your different business lines!
